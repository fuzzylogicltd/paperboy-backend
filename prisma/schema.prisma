generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        Int   @id @default(autoincrement())
  createdAt DateTime @default(now())

  email String    @unique
  password String
  subscriptions Subscription[]
  reads Read[]
}

model Feed {
  id        Int   @id @default(autoincrement())
  createdAt DateTime @default(now())

  name String
  url String @unique
  subscriptions Subscription[]
  articles Article[]
}

model Subscription {
  feedId Int
  userId Int

  tags String?
  subscribedFrom DateTime?

  user User @relation(fields: [userId], references: [id])
  feed Feed @relation(fields: [feedId], references: [id])

  @@id([userId, feedId])
}

model Article {
  id Int @id @default(autoincrement())
  feedId Int

  title String
  url String
  datePublished DateTime
  body String
  imageUrl String

  reads Read[]

  feed Feed @relation(fields:[feedId], references: [id])
}

model Read {
  articleId Int
  userId Int

  readOn DateTime?
  starred Boolean @default(false)

  article Article @relation(fields: [articleId], references: [id])
  user User @relation(fields: [userId], references: [id])

  @@id([articleId, userId])

}